https://bedtools.readthedocs.io/en/latest/content/tools/closest.html

#bedtools closest -a P3F.bed -b TSS_C793_dependent_genes.bed -D b > P3F_near_C793_genes.bed
bedtools closest -a RH4_D6_PAX3FOXO1_GSE116344.nobl.p-14.bed -b sorted_P3F_C-dependent_genelist.bed -D b > P3F_near_C793_genes.bed

#filter by distance (require target gene to be within 500kb of P3F peak)

OR you could run EDEN on P3F.bed, and filter using gene names

once P3F peaks are grouped accordingly, run HOMER annotatePeaks on each group separately, compare the known motif outputs


# Yaw Notes

in R, filter gene_tss5k.clean.bed for genes in 12 or 12 + 1 list

module load bedtools
bedtools closest ^ as above
filter by distance in R (could do in awk in future)
Check if gene label is kept in bedtools closest (want P3F peak associated with gene)

Separate out by gene name
Then on each peak set by gene name, run HOMER annotatePeaks (check if in our own scripts or a command line function)

Check if motif file for each gene available?

EDEN on P3F bed and filter by gene name (run then in R, filter by 12 + 1)


# next steps  - 2023-04-03

Check for -d flag on closest
filter in R by distance and gene name
Run HOMER 13 times

##Bhava
bedtools closest -a RH4_D6_PAX3FOXO1_GSE116344.nobl.p-14.bed -b sorted_TSS_C793-dependent.genelist.bed -D b > P3F_near_C793dependent.bed

bedtools closest -a RH4_D6_PAX3FOXO1_GSE116344.nobl.p-14.bed -b sorted_TSS_C793-low.dependent.genelist.bed -D b > P3F_near_C793_low.dependent.bed

 